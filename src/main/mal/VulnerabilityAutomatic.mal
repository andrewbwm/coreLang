category Vulnerability {

  abstract asset AutomaticVulnerability extends Vulnerability
  {
    | attemptLocalConnectVuln
      user info: "An attacker with low-privilege access on the executing instance is assumed to be able to locally interact with the service."
      +> application.vulnerabilities[LLNNVulnerability].attemptAbuse,
         application.vulnerabilities[LLNRVulnerability].attemptAbuse,
         application.vulnerabilities[LLLNVulnerability].attemptAbuse,
         application.vulnerabilities[LLLRVulnerability].attemptAbuse,
         application.vulnerabilities[LLHNVulnerability].attemptAbuse,
         application.vulnerabilities[LLHRVulnerability].attemptAbuse,
         application.vulnerabilities[LHNNVulnerability].attemptAbuse,
         application.vulnerabilities[LHNRVulnerability].attemptAbuse,
         application.vulnerabilities[LHLNVulnerability].attemptAbuse,
         application.vulnerabilities[LHLRVulnerability].attemptAbuse,
         application.vulnerabilities[LHHNVulnerability].attemptAbuse,
         application.vulnerabilities[LHHRVulnerability].attemptAbuse,
         application.vulnerabilities[UnknownVulnerability].attemptAbuse

    | attemptNetworkRequestConnectVuln
      +> application.vulnerabilities[NLNNVulnerability].attemptAbuse,
         application.vulnerabilities[NLNRVulnerability].attemptAbuse,
         application.vulnerabilities[NLLNVulnerability].attemptAbuse,
         application.vulnerabilities[NLLRVulnerability].attemptAbuse,
         application.vulnerabilities[NLHNVulnerability].attemptAbuse,
         application.vulnerabilities[NLHRVulnerability].attemptAbuse,
         application.vulnerabilities[NHNNVulnerability].attemptAbuse,
         application.vulnerabilities[NHNRVulnerability].attemptAbuse,
         application.vulnerabilities[NHLNVulnerability].attemptAbuse,
         application.vulnerabilities[NHLRVulnerability].attemptAbuse,
         application.vulnerabilities[NHHNVulnerability].attemptAbuse,
         application.vulnerabilities[NHHRVulnerability].attemptAbuse,
         application.vulnerabilities[UnknownVulnerability].attemptAbuse

    | attemptNetworkRespondConnectVuln
      +> application.vulnerabilities[NLNNVulnerability].attemptAbuse,
         application.vulnerabilities[NLNRVulnerability].attemptAbuse,
         application.vulnerabilities[NLLNVulnerability].attemptAbuse,
         application.vulnerabilities[NLLRVulnerability].attemptAbuse,
         application.vulnerabilities[NLHNVulnerability].attemptAbuse,
         application.vulnerabilities[NLHRVulnerability].attemptAbuse,
         application.vulnerabilities[NHNNVulnerability].attemptAbuse,
         application.vulnerabilities[NHNRVulnerability].attemptAbuse,
         application.vulnerabilities[NHLNVulnerability].attemptAbuse,
         application.vulnerabilities[NHLRVulnerability].attemptAbuse,
         application.vulnerabilities[NHHNVulnerability].attemptAbuse,
         application.vulnerabilities[NHHRVulnerability].attemptAbuse,
         application.vulnerabilities[UnknownVulnerability].attemptAbuse

    # userInteracts [Bernoulli(0.5)]
      user info: "Some exploits require user interaction. This defense specifies the probability of such interaction on the given application."
      -> application.vulnerabilities[NLNRVulnerability].abuse,
         application.vulnerabilities[NLLRVulnerability].abuse,
         application.vulnerabilities[NLHRVulnerability].abuse,
         application.vulnerabilities[NHNRVulnerability].abuse,
         application.vulnerabilities[NHLRVulnerability].abuse,
         application.vulnerabilities[NHHRVulnerability].abuse,
         application.vulnerabilities[LLNRVulnerability].abuse,
         application.vulnerabilities[LLLRVulnerability].abuse,
         application.vulnerabilities[LLHRVulnerability].abuse,
         application.vulnerabilities[LHNRVulnerability].abuse,
         application.vulnerabilities[LHLRVulnerability].abuse,
         application.vulnerabilities[LHHRVulnerability].abuse
  }

abstract asset AutomaticLowComplexityVulnerability extends AutomaticVulnerability
{
  & abuse [Exponential(1.0)]
    user info: "The attacker is attempting to abuse a vulnerability in an application."
    -> exploits.impact
}

abstract asset AutomaticHighComplexityVulnerability extends AutomaticVulnerability
{
  & abuse [Exponential(0.01)]
    user info: "The attacker is attempting to abuse a vulnerability in an application."
    -> exploits.impact
}

  asset LLNNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: None, User Interaction: None"
  {
  }

  asset LLNRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: None, User Interaction: Required"
  {
  }

  asset LLLNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: Low, User Interaction: None"
  {
  }

  asset LLLRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: Low, User Interaction: Required"
  {
  }

  asset LLHNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: High, User Interaction: None"
  {
  }

  asset LLHRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: High, User Interaction: Required"
  {
  }

  asset NLNNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: None, User Interaction: None"
  {
  }

  asset NLNRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: None, User Interaction: Required"
  {
  }

  asset NLLNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: Low, User Interaction: None"
  {
  }

  asset NLLRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: Low, User Interaction: Required"
  {
  }

  asset NLHNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: High, User Interaction: None"
  {
  }

  asset NLHRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: High, User Interaction: Required"
  {
  }

  asset LHNNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: None, User Interaction: None"
  {
  }

  asset LHNRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: None, User Interaction: Required"
  {
  }

  asset LHLNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: Low, User Interaction: None"
  {
  }

  asset LHLRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: Low, User Interaction: Required"
  {
  }

  asset LHHNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: High, User Interaction: None"
  {
  }

  asset LHHRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: High, User Interaction: Required"
  {
  }

  asset NHNNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: None, User Interaction: None"
  {
  }

  asset NHNRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: None, User Interaction: Required"
  {
  }

  asset NHLNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: Low, User Interaction: None"
  {
  }

  asset NHLRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: Low, User Interaction: Required"
  {
  }

  asset NHHNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: High, User Interaction: None"
  {
  }

  asset NHHRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: High, User Interaction: Required"
  {
  }

}

category Exploit {

  asset HHHExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: High, Availability Impact: High. An HHH exploit is assumed to grant the attacker full control of the vulnerable application's executing code."
  {
    | impact
      user info: "This exploit is assumed to grant the attacker full control of the vulnerable application's executing code"
      -> vulnerability.application.codeExecution
  }

  asset HHLExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: High, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: High, Availability Impact: Low"
      -> vulnerability.application.read,
         vulnerability.application.modify,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.deny
  }

  asset HHNExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: High, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: High, Availability Impact: None"
      -> vulnerability.application.read,
         vulnerability.application.modify
  }

  asset HLHExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: High"
      -> vulnerability.application.read,
         vulnerability.application.deny,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.modify
  }

  asset HLLExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: Low"
      -> vulnerability.application.read,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.modify,
         vulnerability.application.deny
  }

  asset HLNExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: None"
      -> vulnerability.application.read,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.modify
  }

  asset HNHExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: High"
      -> vulnerability.application.read,
         vulnerability.application.deny
  }

  asset HNLExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: Low"
      -> vulnerability.application.read,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.deny
  }

  asset HNNExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: None"
      -> vulnerability.application.read
  }

  asset LHHExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: High"
      -> vulnerability.application.modify,
         vulnerability.application.deny,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.read
  }

  asset LHLExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: Low"
      -> vulnerability.application.modify,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.read,
         vulnerability.application.deny
  }

  asset LHNExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: None"
      -> vulnerability.application.modify,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.read
  }

  asset LLHExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: High"
      -> vulnerability.application.deny,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.read,
         vulnerability.application.modify
  }

  asset LLLExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: Low"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.read,
         vulnerability.application.modify,
         vulnerability.application.deny
  }

  asset LLNExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: None"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.read,
         vulnerability.application.modify
  }

  asset LNHExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: High"
      -> vulnerability.application.deny,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.read
  }

  asset LNLExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: Low"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.read,
         vulnerability.application.deny
  }

  asset LNNExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: None"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.read
  }

  asset NHHExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: High"
      -> vulnerability.application.modify,
         vulnerability.application.deny
  }

  asset NHLExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: Low"
      -> vulnerability.application.modify,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.deny
  }

  asset NHNExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: None"
      -> vulnerability.application.modify
  }

  asset NLHExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: High"
      -> vulnerability.application.deny,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.modify
  }

  asset NLLExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: Low"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.modify,
         vulnerability.application.deny
  }

  asset NLNExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: Low"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.modify
  }

  asset NNHExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: None, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: None, Availability Impact: High"
      -> vulnerability.application.deny
  }

  asset NNLExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: None, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: None, Availability Impact: Low"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.application.deny
  }
}
