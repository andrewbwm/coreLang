category Vulnerability {

  asset AutomaticVulnerabilityExtensionPoint extends VulnerabilityExtensionPoint
  {
    | localConnect
      user info: "An attacker with low-privilege access on the executing instance is assumed to be able to locally interact with the service."
      +> vulnerabilities[LLNNVulnerability].attemptAbuse,
         vulnerabilities[LLNRVulnerability].attemptAbuse,
         vulnerabilities[LLLNVulnerability].attemptAbuse,
         vulnerabilities[LLLRVulnerability].attemptAbuse,
         vulnerabilities[LLHNVulnerability].attemptAbuse,
         vulnerabilities[LLHRVulnerability].attemptAbuse,
         vulnerabilities[LHNNVulnerability].attemptAbuse,
         vulnerabilities[LHNRVulnerability].attemptAbuse,
         vulnerabilities[LHLNVulnerability].attemptAbuse,
         vulnerabilities[LHLRVulnerability].attemptAbuse,
         vulnerabilities[LHHNVulnerability].attemptAbuse,
         vulnerabilities[LHHRVulnerability].attemptAbuse,
         vulnerabilities[UnknownVulnerability].attemptAbuse

    | networkRequestConnect
      +> vulnerabilities[NLNNVulnerability].attemptAbuse,
         vulnerabilities[NLNRVulnerability].attemptAbuse,
         vulnerabilities[NLLNVulnerability].attemptAbuse,
         vulnerabilities[NLLRVulnerability].attemptAbuse,
         vulnerabilities[NLHNVulnerability].attemptAbuse,
         vulnerabilities[NLHRVulnerability].attemptAbuse,
         vulnerabilities[NHNNVulnerability].attemptAbuse,
         vulnerabilities[NHNRVulnerability].attemptAbuse,
         vulnerabilities[NHLNVulnerability].attemptAbuse,
         vulnerabilities[NHLRVulnerability].attemptAbuse,
         vulnerabilities[NHHNVulnerability].attemptAbuse,
         vulnerabilities[NHHRVulnerability].attemptAbuse,
         vulnerabilities[UnknownVulnerability].attemptAbuse

    | networkRespondConnect
      +> vulnerabilities[NLNNVulnerability].attemptAbuse,
         vulnerabilities[NLNRVulnerability].attemptAbuse,
         vulnerabilities[NLLNVulnerability].attemptAbuse,
         vulnerabilities[NLLRVulnerability].attemptAbuse,
         vulnerabilities[NLHNVulnerability].attemptAbuse,
         vulnerabilities[NLHRVulnerability].attemptAbuse,
         vulnerabilities[NHNNVulnerability].attemptAbuse,
         vulnerabilities[NHNRVulnerability].attemptAbuse,
         vulnerabilities[NHLNVulnerability].attemptAbuse,
         vulnerabilities[NHLRVulnerability].attemptAbuse,
         vulnerabilities[NHHNVulnerability].attemptAbuse,
         vulnerabilities[NHHRVulnerability].attemptAbuse,
         vulnerabilities[UnknownVulnerability].attemptAbuse

    # userInteracts [Bernoulli(0.5)]
      user info: "Some exploits require user interaction. This defense specifies the probability of such interaction on the given application."
      -> vulnerabilities[NLNRVulnerability].abuse,
         vulnerabilities[NLLRVulnerability].abuse,
         vulnerabilities[NLHRVulnerability].abuse,
         vulnerabilities[NHNRVulnerability].abuse,
         vulnerabilities[NHLRVulnerability].abuse,
         vulnerabilities[NHHRVulnerability].abuse,
         vulnerabilities[LLNRVulnerability].abuse,
         vulnerabilities[LLLRVulnerability].abuse,
         vulnerabilities[LLHRVulnerability].abuse,
         vulnerabilities[LHNRVulnerability].abuse,
         vulnerabilities[LHLRVulnerability].abuse,
         vulnerabilities[LHHRVulnerability].abuse
  }

abstract asset AutomaticLowComplexityVulnerability extends Vulnerability
{
  & abuse [Exponential(1.0)]
    user info: "The attacker is attempting to abuse a vulnerability in an application."
    -> exploits.impact
}

abstract asset AutomaticHighComplexityVulnerability extends Vulnerability
{
  & abuse [Exponential(0.01)]
    user info: "The attacker is attempting to abuse a vulnerability in an application."
    -> exploits.impact
}

  asset LLNNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: None, User Interaction: None"
  {
  }

  asset LLNRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: None, User Interaction: Required"
  {
  }

  asset LLLNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: Low, User Interaction: None"
  {
  }

  asset LLLRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: Low, User Interaction: Required"
  {
  }

  asset LLHNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: High, User Interaction: None"
  {
  }

  asset LLHRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: Low, Privileges Required: High, User Interaction: Required"
  {
  }

  asset NLNNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: None, User Interaction: None"
  {
  }

  asset NLNRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: None, User Interaction: Required"
  {
  }

  asset NLLNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: Low, User Interaction: None"
  {
  }

  asset NLLRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: Low, User Interaction: Required"
  {
  }

  asset NLHNVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: High, User Interaction: None"
  {
  }

  asset NLHRVulnerability extends AutomaticLowComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: Low, Privileges Required: High, User Interaction: Required"
  {
  }

  asset LHNNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: None, User Interaction: None"
  {
  }

  asset LHNRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: None, User Interaction: Required"
  {
  }

  asset LHLNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: Low, User Interaction: None"
  {
  }

  asset LHLRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: Low, User Interaction: Required"
  {
  }

  asset LHHNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: High, User Interaction: None"
  {
  }

  asset LHHRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Local, Attack Complexity: High, Privileges Required: High, User Interaction: Required"
  {
  }

  asset NHNNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: None, User Interaction: None"
  {
  }

  asset NHNRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: None, User Interaction: Required"
  {
  }

  asset NHLNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: Low, User Interaction: None"
  {
  }

  asset NHLRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: Low, User Interaction: Required"
  {
  }

  asset NHHNVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: High, User Interaction: None"
  {
  }

  asset NHHRVulnerability extends AutomaticHighComplexityVulnerability
    user info: "Attack Vector: Network, Attack Complexity: High, Privileges Required: High, User Interaction: Required"
  {
  }

}

category Exploit {

  asset HHHExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: High, Availability Impact: High. An HHH exploit is assumed to grant the attacker full control of the vulnerable application's executing code."
  {
    | impact
      user info: "This exploit is assumed to grant the attacker full control of the vulnerable application's executing code"
      -> vulnerability.extensionPoint.application.codeExecution
  }

  asset HHLExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: High, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: High, Availability Impact: Low"
      -> vulnerability.extensionPoint.application.read,
         vulnerability.extensionPoint.application.modify,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.deny
  }

  asset HHNExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: High, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: High, Availability Impact: None"
      -> vulnerability.extensionPoint.application.read,
         vulnerability.extensionPoint.application.modify
  }

  asset HLHExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: High"
      -> vulnerability.extensionPoint.application.read,
         vulnerability.extensionPoint.application.deny,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.modify
  }

  asset HLLExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: Low"
      -> vulnerability.extensionPoint.application.read,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.modify,
         vulnerability.extensionPoint.application.deny
  }

  asset HLNExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: None"
      -> vulnerability.extensionPoint.application.read,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.modify
  }

  asset HNHExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: High"
      -> vulnerability.extensionPoint.application.read,
         vulnerability.extensionPoint.application.deny
  }

  asset HNLExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: Low"
      -> vulnerability.extensionPoint.application.read,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.deny
  }

  asset HNNExploit extends Exploit
    user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: High, Integrity Impact: None, Availability Impact: None"
      -> vulnerability.extensionPoint.application.read
  }

  asset LHHExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: High"
      -> vulnerability.extensionPoint.application.modify,
         vulnerability.extensionPoint.application.deny,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.read
  }

  asset LHLExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: Low"
      -> vulnerability.extensionPoint.application.modify,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.read,
         vulnerability.extensionPoint.application.deny
  }

  asset LHNExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: High, Availability Impact: None"
      -> vulnerability.extensionPoint.application.modify,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.read
  }

  asset LLHExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: High"
      -> vulnerability.extensionPoint.application.deny,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.read,
         vulnerability.extensionPoint.application.modify
  }

  asset LLLExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: Low"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.read,
         vulnerability.extensionPoint.application.modify,
         vulnerability.extensionPoint.application.deny
  }

  asset LLNExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: Low, Availability Impact: None"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.read,
         vulnerability.extensionPoint.application.modify
  }

  asset LNHExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: High"
      -> vulnerability.extensionPoint.application.deny,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.read
  }

  asset LNLExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: Low"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.read,
         vulnerability.extensionPoint.application.deny
  }

  asset LNNExploit extends Exploit
    user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: Low, Integrity Impact: None, Availability Impact: None"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.read
  }

  asset NHHExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: High"
      -> vulnerability.extensionPoint.application.modify,
         vulnerability.extensionPoint.application.deny
  }

  asset NHLExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: Low"
      -> vulnerability.extensionPoint.application.modify,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.deny
  }

  asset NHNExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: High, Availability Impact: None"
      -> vulnerability.extensionPoint.application.modify
  }

  asset NLHExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: High"
      -> vulnerability.extensionPoint.application.deny,
         lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.modify
  }

  asset NLLExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: Low"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.modify,
         vulnerability.extensionPoint.application.deny
  }

  asset NLNExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: None"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: Low, Availability Impact: Low"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.modify
  }

  asset NNHExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: None, Availability Impact: High"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: None, Availability Impact: High"
      -> vulnerability.extensionPoint.application.deny
  }

  asset NNLExploit extends Exploit
    user info: "Confidentiality Impact: None, Integrity Impact: None, Availability Impact: Low"
  {
    | impact
      user info: "Confidentiality Impact: None, Integrity Impact: None, Availability Impact: Low"
      -> lowImpact

    | lowImpact @hidden [Bernoulli(0.5)]
      -> vulnerability.extensionPoint.application.deny
  }
}
