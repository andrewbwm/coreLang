category Vulnerability {

  abstract asset Vulnerability
  {
    | incoming @hidden
      developer info: "This attack step will be used as a single entry point for all vulnerabilities in the manual modeling scenario."

    | attemptLocalConnectVuln
      developer info: "This attack step (and the following two) will be used as different entry points for all vulnerabilities in the automatic modeling scenario."

    | attemptNetworkRequestConnectVuln
      developer info: "This attack step (and the following one) will be used as different entry points for all vulnerabilities in the automatic modeling scenario."

    | attemptNetworkRespondConnectVuln
      developer info: "This attack step will be used as different entry points for all vulnerabilities in the automatic modeling scenario."

    # userInteracts
      user info: "Some exploits require user interaction. This defense specifies the probability of such interaction on the given application."

    # remove
      user info: "If the remove defense is enabled the vulnerability will not be effective on the model."
      ->  abuse

     | attemptAbuse @hidden
       -> abuse

     & abuse
       user info: "The attacker is attempting to abuse a vulnerability in an application."
       -> exploits.impact
  }

  asset UnknownVulnerability extends Vulnerability
    developer info: "Meant to capture vulnerabilities without CVE or to model what-if scenarios where the parser controls the impact and distribution based on e.g., Attacker Profiles"
    modeler info: "To be used together with Exploit specializations based on your modeling scenario"
  {
  }

}

category Exploit {
    
  abstract asset Exploit
    user info: "An exploited vulnerability lead to some kind of impact. The kind is given by CVSS 3.0."
  {
    | impact
  }

  asset UnknownExploit extends Exploit
    user info: "Potential unknown exploits that might occur due flaws or configuration errors in software, e.g., 0-day exploits or exploits not discovered by scanners."
    modeler info: "The specialization is assumed to be used with the UnknownVulnerability asset"
    developer info: "Distributions are omitted and are meant to be controlled by a parser based on e.g., scenarios or threat profiles"
  {
    | impact @hidden
      -> requestForgery,
        codeExecution,
        modify,
        deny,
        read

   | requestForgery
      user info: "Request Forgery attacks occur when the attacker can create or control transmissions from a vulnerable application."
      -> vulnerability.application.appConnections.transmit,
         vulnerability.application.appConnections.transmitResponse

   | codeExecution
      user info: "The attacker is able to inject code into the application process, thus assuming the application's privileges on the hosting instance and influence other applications or the underlying OS."
      -> vulnerability.application.codeExecution

   | modify
     user info: "The attacker can modify some or all of this application's data."
      ->  vulnerability.application.modify

    | deny
      user info: "Denial-of-service attack is an attack in where a machine or network resource is rendered unavailable to its intended users by temporarily or indefinitely disrupting it"
      -> vulnerability.application.deny

    | read
      user info: "The attacker can read some or all of this applications's code and data."
      -> vulnerability.application.read
  }
}

associations {
  Object                      [object]         0..1 <-- ObjectVulnerability      --> * [objvulnerabilities] Vulnerability
      developer info: "Every Object in the model can be connected to any Vulnerability."
  Vulnerability               [vulnerabilities]   * <-- ApplicationVulnerability --> 0..1 [application]     Application
      developer info: "Every Application can also be connected to any Vulnerability."
  Vulnerability               [vulnerability]     1 <-- VulnerabilityExploit     --> *    [exploits]        Exploit

}
